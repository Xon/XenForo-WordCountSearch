<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="SV_WordCountSearch" title="Enhanced Search Improvements - Word Count" version_string="1.1.4" version_id="1010400" url="https://xenforo.com/community/resources/enhanced-search-improvements-word-count.4763/" install_callback_class="SV_WordCountSearch_Installer" install_callback_method="install" uninstall_callback_class="SV_WordCountSearch_Installer" uninstall_callback_method="uninstall">
  <admin_navigation/>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates/>
  <admin_template_modifications/>
  <code_events/>
  <code_event_listeners>
    <listener event_id="load_class_model" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="Sidane_Threadmarks_Model_Threadmarks" description="Sidane_Threadmarks_Model_Threadmarks"/>
    <listener event_id="load_class_model" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenForo_Model_Thread" description="XenForo_Model_Thread"/>
    <listener event_id="load_class" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenForo_Search_DataHandler_Thread" description="XenForo_Search_DataHandler_Thread"/>
    <listener event_id="load_class_datawriter" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="Sidane_Threadmarks_DataWriter_Threadmark" description="Sidane_Threadmarks_DataWriter_Threadmark"/>
    <listener event_id="load_class_datawriter" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenForo_DataWriter_Discussion_Thread" description="XenForo_DataWriter_Discussion_Thread"/>
    <listener event_id="load_class_model" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenES_Model_Elasticsearch" description="XenES_Model_Elasticsearch"/>
    <listener event_id="load_class" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenES_Search_SourceHandler_ElasticSearch" description="XenES_Search_SourceHandler_ElasticSearch"/>
    <listener event_id="load_class" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenForo_Search_DataHandler_Post" description="XenForo_Search_DataHandler_Post"/>
    <listener event_id="load_class_datawriter" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenForo_DataWriter_DiscussionMessage_Post" description="XenForo_DataWriter_DiscussionMessage_Post"/>
    <listener event_id="load_class_model" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenForo_Model_Post" description="XenForo_Model_Post"/>
    <listener event_id="load_class_model" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenForo_Model_Search" description="XenForo_Model_Search"/>
    <listener event_id="load_class_controller" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerPublic_Search" description="XenForo_ControllerPublic_Search"/>
    <listener event_id="load_class_controller" execute_order="4763" callback_class="SV_WordCountSearch_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerPublic_Thread" description="XenForo_ControllerPublic_Thread"/>
  </code_event_listeners>
  <cron/>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups/>
  <permissions>
    <permission_groups/>
    <permissions/>
    <interface_groups/>
  </permissions>
  <phrases>
    <phrase title="word_count" version_id="1000000" version_string="1.0.0"><![CDATA[Word Count]]></phrase>
    <phrase title="word_count_lower_bound" version_id="1000000" version_string="1.0.0"><![CDATA[Lower bound]]></phrase>
    <phrase title="word_count_upper_bound" version_id="1000000" version_string="1.0.0"><![CDATA[Upper bound]]></phrase>
  </phrases>
  <route_prefixes/>
  <style_properties/>
  <templates>
    <template title="SV_WordCountSearch_search_form" version_id="1000600" version_string="1.0.6"><![CDATA[<xen:if is="{$search.range_query}">
<dl class="ctrlUnit">
		<dt><label for="ctrl_word_count_lower">{xen:phrase word_count}:</label></dt>
		<dd>
			<input type="number" placeholder="{xen:phrase word_count_lower_bound}" name="word_count[lower]" value="{$search.word_count.lower}" class="textCtrl" id="ctrl_word_count_lower" /> - 
			<input type="number" placeholder="{xen:phrase word_count_upper_bound}" name="word_count[upper]" value="{$search.word_count.upper}" class="textCtrl" id="ctrl_word_count_upper" />
		</dd>
	</dl>
</xen:if>]]></template>
  </templates>
  <public_template_modifications>
    <modification template="search_bar" modification_key="SV_WordCountSearch_search_bar_1" description="Inject Word count filter" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if is="{$searchBar}">]]></find>
      <replace><![CDATA[<xen:if is="{$searchBar.forum} || {$searchBar} == null">
<dl class="ctrlUnit">
	<dt><label for="ctrl_word_count_lower">{xen:phrase word_count}:</label></dt>
	<dd>
		<input type="number" placeholder="{xen:phrase word_count_lower_bound}" name="word_count[lower]" value="{$search.word_count.lower}" class="textCtrl" id="ctrl_word_count_lower" />
	</dd>
</dl>
</xen:if>
$0]]></replace>
    </modification>
    <modification template="search_form" modification_key="SV_WordCountSearch_search_form_1" description="Inject Word count filter" execution_order="4763" enabled="1" action="preg_replace">
      <find><![CDATA[#{xen:phrase newer_than.*?</dl>#si]]></find>
      <replace><![CDATA[$0
<xen:include template="SV_WordCountSearch_search_form" />]]></replace>
    </modification>
    <modification template="search_form_post" modification_key="SV_WordCountSearch_search_form_post" description="Inject Word count filter" execution_order="4763" enabled="1" action="preg_replace">
      <find><![CDATA[#xen:phrase newer_than.*?</dl>#si]]></find>
      <replace><![CDATA[$0
<xen:include template="SV_WordCountSearch_search_form" />]]></replace>
    </modification>
    <modification template="search_result_post" modification_key="SV_WordCountSearch_search_result_post_1" description="Inject Word count" execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#\w*{xen:phrase post_by}#si]]></find>
      <replace><![CDATA[<xen:if is="{$post.WordCount}">
{xen:phrase word_count}: <a class="wordcount">{$post.WordCount}</a>,
</xen:if>
$0]]></replace>
    </modification>
    <modification template="search_result_thread" modification_key="SV_WordCountSearch_search_result_thread_1" description="Inject Word count" execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#\w*{xen:phrase thread_by}#si]]></find>
      <replace><![CDATA[<xen:if is="{$thread.WordCount}">
{xen:phrase word_count}: <a class="wordcount">{$thread.WordCount}</a>,
</xen:if>
$0]]></replace>
    </modification>
    <modification template="threadmark_preview" modification_key="SV_WordCountSearch_threadmark_preview_count" description="Adds total word count to Threadmark preview" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:datetime time="{$post.post_date}" class="faint" />]]></find>
      <replace><![CDATA[$0
<xen:if is="{$post.WordCount}">
, {xen:phrase word_count}: <a class="wordcount">{$post.WordCount}</a>
</xen:if>]]></replace>
    </modification>
    <modification template="threadmarks" modification_key="SV_WordCountSearch_threadmarks_post_count" description="Adds word count to post titles on Threadmarks index" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<a href="{xen:link threads/post-permalink, $thread, 'post={$threadmark.post}'}"
             class="{xen:if $thread.hasPreview, PreviewTooltip}"
             data-previewUrl="{xen:if $thread.hasPreview, {xen:link posts/threadmarkpreview, $threadmark}}">{$threadmark.label}
          </a>]]></find>
      <replace><![CDATA[$0
<xen:if is="{$threadmark.WordCount}">
({$threadmark.WordCount})
</xen:if>]]></replace>
    </modification>
    <modification template="threadmarks" modification_key="SV_WordCountSearch_threadmarks_total_count" description="Adds total word count to Threadmarks index" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<div class="sectionFooter overlayOnly"><a class="button primary OverlayCloser">{xen:phrase close}</a></div>]]></find>
      <replace><![CDATA[<div class="sectionFooter"><xen:if is="{$thread.WordCount}">{xen:phrase word_count}: {$thread.WordCount}</xen:if> <a class="button primary overlayOnly OverlayCloser">{xen:phrase close}</a></div>]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
  <bb_codes/>
</addon>
